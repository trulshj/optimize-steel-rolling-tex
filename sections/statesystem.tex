\section{Existence and uniquenes for the optimal control\\\mbox{problem}}\label{proof}

\subsection{Existence and uniqueness state system}
We will now consider the existence of a solution to the state equation. In order to do so, we consider a more general linear parabolic partial differential equation, show a solution exists for this general form. We then use that result to conclude about the existence for our particular problem as well.

Consider the PDE given by
%
\begin{align}
    \label{eq:moreGen}
    u_t - Au + c_0 y = f \quad \text{in } Q = \Omega \times (0,T) \\
    \label{eq:moreGen2}\partial_{n_A} u + \alpha u = g \quad \text{on } \Sigma = \Gamma \times (0,T) \\
    u(\placeholder,0) = u_0(\placeholder) \quad \text{in } \Omega
\end{align}
It does not predescribe any difficulties by splitting the boundary $\Gamma$ into disjoint parts
and predescribe Neumann conditions on these sections separately, as we have done in \ref{eq:heat}. The functions $\alpha$, $\beta$, $f$ and $g$ all depend on $(x,t)$. Here $A$ is an elliptic differential operator of the following form:
%
\begin{equation*}
    Af(x) \coloneqq -\sum_{i,j}^N\frac{\partial}{\partial x_i}(a_{ij}(x)\frac{\partial}{\partial x_j}f(x)) \quad x\in \Omega
\end{equation*}
One need some requirements on the coefficents of the matrix $A=(a_{ij})$, that is one require $a_{ij} \in L^{\infty}(\Omega)$ and that they are symmetric, i.e. $a_{ji}(x) = a_{ij}(x)$ for $x\in \Omega$. Moreover, one also assumes that the uniform ellipticity condition is satisfied, that is there is some $M > 0$ such that 
\begin{equation*}
    \label{eq:uniformEl}
    \sum_{i,j}^N a_{ij}(x)x_i x_j \geq M|x|^2 \quad \forall x \in \mathbb{R}^N \text{ for a.e. $x\in \Omega$}
\end{equation*}
The operator $\partial_{n_A}$ is the directional derivative of the conormal vector $n_{A}$, a vector whose components are given by $n_{A} = An$, where A is the elliptic differential operator. We present a theorem stating the existence and uniqueness for a solution to \eqref{eq:moreGen}. 

\begin{theorem}[Existence and uniqueness] Assume that $\Omega \subset \mathbb{R}^n$ is a bounded Lipschitz domain with boundary $\Gamma$ and let $T>0$ denote the final time. Moreover, assume $c_0 \in L^{\infty}(Q)$ and $\alpha \in L^{\infty}(\Sigma)$, where $\alpha(x,t) \geq 0$ for a.e. $(x,t) \in \Sigma$, $y_0 \in L^2(\Sigma), f \in L^2(Q)$, and $g \in L^2(\Sigma)$. Then the parabolic initial-value problem \eqref{eq:moreGen} has a unique weak solution in $W_2^{1,0}(Q) \cap L^{\infty}(0,T;L^2(\Omega))$. Moreover, there is a constant $C>0$ which is independent of $f$, $g$ and $u_0$ such that 
\begin{equation*}
    \max_{t \in [0,T]} \|u(.,t)\|_{L^2(\Omega)} + \|u\|_{W_2^{1,0}(Q)} \leq C\left(\|f\|_{L^2(Q)} + \|g\|_{L^2(\Sigma)} + \|u_0\|_{L^2(\Omega)}\right).
\end{equation*}
This holds for all $f \in L^2(Q), g \in L^2(\Sigma)$ and $u_0 \in L^2(\Omega)$
\end{theorem}

\begin{proof}
The proof is given by TrÃ¶ltzsch in \cite{optimalControl} under theorem 7.8. We will provide a rough sketch of the required steps in the proof. WOLOG one may assume that $c_0(x,t)\geq 0$ for a.e. $(x,t) \in Q$, since if that were not the case one could do the substitution $y(x,t) \rightarrow e^{\lambda t}\bar{y}(x,t)$. Then the resulting differential equation for $\bar{y}$ involves the term $(\lambda + c_0)\bar{y}$ instead of $c_0y$ as in the original PDE. Taking $\lambda >0$ large enough, this will certainly be positive. 

In order to prove the existence in the theorem one need to proceed in 4 steps, these are

\begin{enumerate}
    \item Make a Galerkin approximation to the problem,
    \item Estimate the sequence $\{y_n \}$ which is an approximation sequence for the states of the PDE
    \item Consider the convergence of the sequence of estimated controls $\{u_j^N\}_j$ and states $\{ y_n \}$
    \item Show that the limit $y_n \rightarrow y$ is indeed a weak solution to the PDE.
\end{enumerate}
To prove uniqueness, one has to use an energy inequality together with the regularity of the solution.
\end{proof}


From this theorem, we can make a conclusion regarding the existence of a solution to our particular parabolic PDE. Let $c_0 = 0$, $A = \frac{1}{\rho c_p}\nabla \cdot (k\nabla)$, and $f = 0$. Then $\partial_{n_A} = \partial_n$. We also set $\Gamma = \Gamma_1 \cup \Gamma_2$, to partition our boundary into to disjoint separate parts, now let $\alpha_1 = -\frac{u(t)}{k}$ and $g_1 = -\frac{u(t)\theta_w}{k}$, while one set $\alpha_2 = 0, g_2 = 0$, where $\alpha_i$ is the value of $\alpha$ on $\Sigma_i$ and similarly for $g_i$. This results in the next corollary. 

\begin{corollary}[Existence]
Suppose that $\theta_w \in L^{\infty}(\Sigma_1)$, $\theta_0 \in L^2(\bar{\Omega})$, $u \in L^{\infty}(0,T)$ and $u\geq 0$. Then the initial value \eqref{eq:heat} admits a unique solution $\theta \in W_2^{1,0}(Q)$. After a possible modification on a null set, we have $\theta \in W(0,T)$. This weak solution to the PDE satisfy an upper bound 
\begin{equation*}
    \|\theta \|_{W(0,T)} \leq C\bigg ( \|g_1\|_{L^2(\Sigma)} + \|\theta_0\|_{L^2(\Sigma)} \bigg )
\end{equation*}
for a constant $C>0$ independent on $(g_1, \theta_0)$
\end{corollary}

Actually using theorem 5.5 in \cite{optimalControl} we get that our solution 
\begin{equation*}
    \theta \in W(0,T) \cap C (\bar{Q})
\end{equation*}
and as we will see the solution to the adjoint system satisfy have the same regularity using a time transformation. 


\subsection{Existence and uniqueness Adjoint system}
Want to prove that there exist a unique weak solution $p \in W_2^{1,0}(Q)$ to our adjoint system, and modifying $p$ on a nullset we get $p\in W(0,t)$. We consider the sightly more general parabolic initial-boundary value problem 
\begin{align*}
    -p_t -\nabla^2p +c_0p = a_Q \qquad \text{in } Q, \\
    \partial_np + \alpha p = a_{\Sigma} \qquad \text{on } \Sigma, \\
    p|_{t=T} = a_{\Omega} \qquad \text{in } \Omega.
\end{align*}
If we assume bounded and measurable coefficient functions i.e. $c_0, \alpha, a_Q \in L^2(Q)$, $a_{\Sigma} \in L^2(\Sigma)$, and $a_{\Omega} \in L^2(\Omega)$, then we can introduce a bilinear form
\begin{equation}
    \label{eq:parabolic_adj}
    A(y,v)(t) := \int_{\Omega}(\nabla y \cdot \nabla v + c_0(\placeholder,t) y v) \dx + \int_{\Gamma}\alpha(\placeholder,t) y v \ds
\end{equation}
Then the stated PDE is well-posed according to the following Lemma:

\begin{lemma}[Well-posedness]
The parabolic adjoint system given in \eqref{eq:parabolic_adj} has a unique weak solution $p \in W_2^{1,0}(Q)$ which is a solution to the variational problem 
\begin{equation*}
    \iint_Q pv_t \dxdt + \int_0^TA(p,v)(t)\dt = \int_{\Omega}a_{\Omega}v(T) \dt + \iint_Q a_Qv \dxdt + \iint_{\Sigma}a_{\Sigma}v \dsdt
\end{equation*}
this should hold for all $v \in H^{1,1}(Q)$ with $v|_{t=0} = 0$. If we modify $p$ on a null set we have $p\in W(0,T)$, and there exists some constant $M>0$ that does not depend on $(a_Q,a_{\Sigma}, a_{\Omega})$ such that 
\begin{equation*}
    \|p\|_{W(0,T)} \leq M \bigg (\|a_Q\|_{L^2(Q)} + \|a_{\Sigma}\|_{L^2(\Sigma)} + \|a_{\Omega}\|_{L^2(\Omega)} \bigg ).
\end{equation*}
\end{lemma}

\begin{proof}
The idea is to reduce the system to a forward parabolic initial-boundary value problem. This is done with a time transformation, taking $\tau \in [0,T]$ and introducing
\begin{equation*}
    \hat{p}(\tau) := p(T-\tau).
\end{equation*}
A similar transform is applied with $\hat{v}(\tau)$. Then $\hat{p}(0) = p(T)$ and $\hat{p}(T) = p(0)$; analogously for $\hat{v}$. We have that $\hat{a_Q}(\placeholder,t):= a_Q(\placeholder,T-\tau)$, and likewise for all the other coefficients. Due to this time transform, we have that
\begin{equation*}
    \iint_Qpv_t \dxdt = - \iint_Q \hat{p}\hat{v_{\tau}} \dxdt.
\end{equation*}
Considering the weak formulation, it now corresponds to the forward parabolic initial-boundary value problem given by 
\begin{align*}
    \hat{p_{\tau}} - \nabla^2 \hat{p} + c_0 \hat{p} = \hat{a_Q} \qquad \text{in } Q \\
    \partial_n \hat{p} + \alpha \hat{p} = \hat{a_{\Sigma}} \qquad \text{on } \Sigma \\
    \hat{p}(0) = \hat{a_{\Omega}} \qquad \text{in } \Omega
\end{align*}
By the previous existence and uniqueness theorem, this problem admits a unique weak solution $\hat{p} \in W(0,T)$. Reversing the time transformation we have proven uniqueness and existence for the adjoint system.
\end{proof}
This system is more general than ours, so we can reduce it to our case. Consider \eqref{eq:adjoint-eqn}, if we set $c_0 = 0$, $a_Q = 0$ and split up the boundary $\Sigma = \Sigma_1 \cup \Sigma_2$ where we set $\alpha_1 = \frac{u(t)}{k}$ and $\alpha_2 = 0$, $a_{\Sigma_i}=0$ for $i\in \{1,2 \}$ and finally set $a_{\Omega} = \theta|_{t=T}-\theta_d$ we have reduced to the case of the lemma, consequently we have existence and uniqueness for \eqref{eq:adjoint-eqn}.



\subsection{Existence of optimal control}
Under the required conditions for a solution to \eqref{eq:heat} we can go on to prove the existence of an optimal control $\bar{u}$. 

\begin{lemma}[WLSC]
    The cost functional given b y
    \begin{equation*}
         J(\theta, u) = \frac{1}{2} \int_\Omega (\theta(x, T) - \theta_d)^2 \mathop{dx} + \frac{\gamma}{2} \int_0^{T} u^2 \mathop{dt}
    \end{equation*}
    is weakly lower semicontinous (WLSC). 
\end{lemma}

\begin{proof}
We can reformulate the cost functional $J(\theta, u)$ in terms of norms as 
\begin{equation*}
    J(\theta, u) = \frac{1}{2}\|\theta (,T) - \theta_d \|_{L^2(\Omega)}^2 + \frac{\gamma}{2}\|u\|_{L^2(0,T)}^2
\end{equation*}
Now a norm is convex by applying the triangle inequality and continuity of the norm follows by an application of the reverse triangle inequality. This thus implies that the cost functional is weakly lower semicontinuous in both arguments.
\end{proof}

\begin{theorem}[Optimal Control]
If the assumptions in the existence corollary are all satisfied, then there exist at least one solution to the optimal control problem 
\begin{equation*}
       \min J(\theta, u) = \frac{1}{2} \int_\Omega (\theta(x, T) - \theta_d)^2 \mathop{dx} \mathop{dt} + \frac{\gamma}{2} \int_0^{T} u^2 \mathop{dt}
\end{equation*}
subject to
\begin{align*}
       \rho c_p \theta_t - \nabla \cdot (k \nabla \theta) &= 0 &&\text{in } Q,  \\
      -k \frac{\partial \theta}{\partial \nu} &= u(t) (\theta - \theta_w) &&\text{on } \Sigma_1, \\
      -k \frac{\partial \theta}{\partial \nu} &= 0 \quad &&\text{on } \Sigma_2, \\
      \theta(x, 0) &= \theta_0 && \text{in $\Omega$.}
\end{align*}
\end{theorem}

\begin{proof}
We follow the same footsteps as in  \cite{DPSteel}. By the existence corollary for the parabolic PDE we know that  for any $u \in U_{ad} \text{ } \exists \text{ }\theta \in W(0,T)\cap C(\bar{Q})$. The set of admissible controls $U_{ad}$ is bounded in $L^{\infty}(0,T)$ therefore the solution $\theta$ is bounded in $W(0,T) \cap C(\bar{Q})$ thus the cost functional will be bounded. We can as a consequence assume we have a minimising sequence which we represent by the tuple $\{(\theta_k,u_k)\}_{k\in \mathbb{N}}$ such that we have 
\begin{equation*}
    \lim_{k\rightarrow \infty}J(\theta_k,u_k) = \inf_{(\theta,u)\in (W(0,T) \cap C(\bar{Q})\times U_{ad}}J(\theta,u)
\end{equation*}
where $(\theta_k,y_k) = S(u_k)$ where $S(\placeholder)$ is the solution operator which assigns the solution to the state system for a given control $u_k$.

Now $U_{ad}$ is a closed linear subspace of the Banach space $L^{\infty}(0,T)$, and is therefore itself a  Banach space, furthermore $U_{ad}$ is bounded and convex, so the sequence $\{u_k\}$ will be bounded, and there exist a weakly convergent subsequence of the controls $\{u_{k'} \} \subset \{u_k \}$ and a limit $\bar{u} \in L^{\infty}(0,T)$ such that
\begin{equation*}
    u_{k'} \rightharpoonup \bar{u} \text{ in } L^2(0,T).
\end{equation*}

Now since $U_{ad}$ is closed and convex, $U_{ad}$ is weakly closed, therefore $\bar{u} \in U_{ad}$. \bigskip

Using our existence corollary we know there exist a unique solution to the state system also with the control $\bar{u}$. Extracting a further subsequence if necessary still indexed by $k'$ we have that 

\begin{equation*}
    \theta_{k'} \rightharpoonup \bar{\theta} \text{ weakly in } W(0,T) \text{ and strongly in } L^2(Q)
\end{equation*}
We want to show that this limit is a solution to the weak form of our state system. We use the weak from as derived in Section 2.1 but now with $\theta_{k'}$ and $u_{k'}$ instead 

Take a test function $\phi \in W(0,T)$ and integrate over our space-time cylinder $Q$ we then have 
\begin{align*}
    \rho c_p \int_0^T\int_{\Omega}\frac{\partial \theta_{k'}}{\partial t}\phi \dxdt + k \int_0^T \int_{\Omega}\nabla \theta_{k'} \cdot \nabla \phi \dxdt \\ + \int_0^T \bigg (\int_{\Gamma_1}\theta_{k'}\phi \ds \bigg )u_{k'}(t) \dt =
    \int_0^T \bigg (\int_{\Gamma_1}\theta_w\phi \ds \bigg ) u_{k'} \dt 
\end{align*}
We want to see what happens if we pass to the limit $k' \rightarrow \infty$ in the equation. All terms appearing in the weak formulation are linear in $\theta_{k'}$ and $u_{k'}$. Due to the continuity of the solution $\theta_{k'}$ ($\theta_{k'} \in W(0,T) \cap C(\bar{Q})$ when we pass to the limit we get that the limit $\bar{\theta}$ solves the weak formulation of our state system with control $\bar{u}$. The solution to the state system is unique, thus we can set
\begin{align*}
    \theta(\bar{u}) = \bar{\theta} 
\end{align*}
Now by lower semicontinuity as derived in the previous lemma, we have that  
\begin{align*}
    J(\bar{\theta}, \bar{u}) \leq \lim \inf_{k'} J(\theta_{k'}, u_{k'}),
\end{align*}
and therefore the solution $(\bar{\theta}, \bar{u})$ is optimal, and hence there exists at least one optimal control.  
\end{proof}